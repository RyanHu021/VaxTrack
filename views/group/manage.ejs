<div class="container">
    <h1 class="mt-4">Manage Group</h1>
    <div>Group: <%= group.name %></div>
    <div class="mb-4">Members: <%= group.members %>, Fully Vaccinated: <%= group.fullVax %></div>
    <% let count = 0 %>
    <% users.forEach(user => { %>
        <% if (user.needReview) { %>
            <% count++ %>
        <% } %>
    <% }) %>
    <% if (count > 0) { %>
        <div class="alert alert-warning"><%= count %> user(s) have requested a supervisor review.</div>
    <% } %>
    <style>
        .th-link {
            color: black;
            text-decoration: none; 
            background-color: none;
        }
    </style>
    <a href="/user/new/" class="btn btn-success">Add User</a>
    <a href="/group/import" class="btn btn-info" target="_blank">Import Data</a>
    <a href="/group/export" class="btn btn-info" target="_blank">Export Data</a>
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th scope="col"><a href="/group/manage?sort=name" class="th-link">Name</a></th>
                <th scope="col"><a href="/group/manage?sort=email" class="th-link">Email Address</a></th>
                <th scope="col"><a href="/group/manage?sort=status" class="th-link">Vaccination Status</a></th>
                <th scope="col"><a href="/group/manage?sort=date" class="th-link">Date Updated</a></th>
                <th scope="col"><a href="/group/manage?sort=role" class="th-link">Role</a></th>
                <th scope="col">Action</th>
            </tr>
        </thead>
        <tbody>
            <% users.forEach(user => { %>
                <tr>
                    <th scope="row" <% if (user.needReview) { %>
                        class="text-danger"
                    <% } %>> <%= `${user.firstName} ${user.lastName}` %></th>
                    <td><%= user.email %></td>
                    <td>
                        <% if (user.vaccineStatus === 1) { %>
                            Partially Vaccinated
                        <% } else if (user.vaccineStatus === 2) { %>
                            Fully Vaccinated
                        <% } else { %>
                            Not Vaccinated
                        <% } %>
                    </td>
                    <td><%= user.dateUpdated.toLocaleString() %></td>
                    <td><%= user.role %></td>
                    <td>
                        <% if ((role === 'owner' && user.role !== 'owner') || (role === 'supervisor' && user.role === 'user')) { %>
                            <a href="/user/edit/<%= user.id %>">Edit</a>
                            <div class="d-inline">|</div>
                            <a href="/user/delete/<%= user.id %>">Delete</a>
                        <% } else if (role === user.role) { %>
                            <a href="/user/edit/<%= user.id %>">Edit</a>
                        <% } %>
                    </td>
                </tr>
            <% }) %>
        </tbody>
    </table>
</div>